# ğŸ§¾ ConciliaÃ§Ã£o Cotidiano (PDF Wizard)

AplicaÃ§Ã£o web em **Flask** para upload, visualizaÃ§Ã£o e ediÃ§Ã£o de PDFs diretamente no navegador.

VocÃª consegue:

- Enviar um PDF e visualizar em alta qualidade
- Rotacionar pÃ¡ginas
- Inserir marca dâ€™Ã¡gua
- Baixar qualquer pÃ¡gina como **PNG**
- Inserir imagens dentro do PDF
- Mesclar com outros PDFs
- Extrair texto de todo o documento
- Abrir o conteÃºdo em um editor estilo **Word** (TinyMCE)

Interface pensada para o dia a dia de rotinas de DP/Folha.

---

## ğŸš€ Tecnologias principais

**Backend**

- Python 3.x
- Flask
- PyMuPDF (`fitz`) â€“ leitura/ediÃ§Ã£o de PDF e geraÃ§Ã£o de PNG
- pypdf â€“ manipulaÃ§Ã£o de pÃ¡ginas / merge / rotaÃ§Ã£o
- reportlab â€“ geraÃ§Ã£o de marca dâ€™Ã¡gua
- Pillow â€“ tratamento de imagens
- python-dotenv â€“ variÃ¡veis de ambiente

**Frontend**

- Tailwind CSS (via CDN)
- pdf.js â€“ renderizaÃ§Ã£o do PDF no canvas
- fabric.js â€“ overlay de ediÃ§Ã£o (caixas de texto, etc.)
- TinyMCE 6 (via Tiny Cloud) â€“ editor rich text estilo Word

---

## ğŸ“ Estrutura de pastas

```text
pdfwizard/
â”œâ”€ app.py                 # App Flask (rotas e APIs)
â”œâ”€ pdf_tools.py           # FunÃ§Ãµes auxiliares para PDF (extra)
â”œâ”€ requirements.txt
â”œâ”€ Procfile               # ConfiguraÃ§Ã£o para deploy com gunicorn (Render, etc.)
â”œâ”€ .env                   # VariÃ¡veis de ambiente (local, nÃ£o versionar)
â”œâ”€ uploads/               # PDFs enviados (criado em runtime)
â”œâ”€ templates/
â”‚  â”œâ”€ base.html           # Layout base (header/footer)
â”‚  â”œâ”€ index.html          # Tela inicial + upload
â”‚  â””â”€ painel.html         # Painel de ediÃ§Ã£o do PDF
â””â”€ static/
   â””â”€ js/
      â””â”€ upload.js        # (se utilizado) lÃ³gica de upload via JS
ğŸ” VariÃ¡veis de ambiente
Crie um arquivo .env na raiz do projeto (mesma pasta do app.py) com:

env
Copiar cÃ³digo
TINYMCE_API_KEY=SUAS_CHAVE_DO_TINYMCE_AQUI

# opcionais
FLASK_ENV=development
FLASK_DEBUG=1
Importante: a TINYMCE_API_KEY Ã© gerada no painel do Tiny Cloud.
Em produÃ§Ã£o (Render / Railway / etc.) vocÃª cadastra essas variÃ¡veis direto no painel da plataforma â€“ nÃ£o sobe o .env para o Git.

ğŸ‘¨â€ğŸ’» Rodando localmente
Clonar o repositÃ³rio

bash
Copiar cÃ³digo
git clone https://github.com/seu-usuario/pdfwizard.git
cd pdfwizard
Criar e ativar o ambiente virtual

bash
Copiar cÃ³digo
python -m venv .venv

# Windows
.venv\Scripts\activate

# Linux / Mac
source .venv/bin/activate
Instalar dependÃªncias

bash
Copiar cÃ³digo
pip install -r requirements.txt
Criar o .env (se ainda nÃ£o criou)

env
Copiar cÃ³digo
TINYMCE_API_KEY=SUAS_CHAVE_DO_TINYMCE
FLASK_ENV=development
FLASK_DEBUG=1
Rodar o servidor

bash
Copiar cÃ³digo
python app.py
A aplicaÃ§Ã£o sobe em:

text
Copiar cÃ³digo
http://127.0.0.1:5000
ğŸ§© Funcionalidades do painel
No painel (/painel?filename=...) vocÃª tem:

1. VisualizaÃ§Ã£o do PDF
PDF renderizado via pdf.js em um canvas.

NavegaÃ§Ã£o de pÃ¡ginas (anterior / prÃ³xima).

SobreposiÃ§Ã£o com fabric.js para criaÃ§Ã£o de caixas de texto (modo ediÃ§Ã£o visual).

2. Ferramentas principais (APIs)
Rotacionar PDF

Chama POST /api/rotate

ParÃ¢metro: degrees (90, 180, 270)

Sobrescreve o arquivo atual.

Marca dâ€™Ã¡gua

Chama POST /api/watermark

Cria um PDF de watermark com reportlab e mescla em todas as pÃ¡ginas.

PÃ¡gina como PNG

Chama POST /api/page_png

Usa PyMuPDF para renderizar a pÃ¡gina e retorna image/png para download.

Inserir imagem no PDF

Chama POST /api/insert_image

ParÃ¢metros: page, x, y, w + arquivo image

Insere a imagem na coordenada indicada e salva o PDF.

Mesclar PDFs

Chama POST /api/merge

Recebe mÃºltiplos arquivos .pdf e faz insert_pdf em sequÃªncia.

Extrair texto

Chama POST /api/extract_text

Percorre as pÃ¡ginas com PyMuPDF (get_text()) e devolve todo o texto numa string.

3. Editar como Word (TinyMCE)
BotÃ£o â€œEditar como Wordâ€ abre um modal com o TinyMCE.

Ao abrir:

Front chama /api/extract_text

O texto extraÃ­do Ã© jogado no editor dentro de um <pre> (mantendo quebras de linha).

O botÃ£o â€œSalvar alteraÃ§Ãµesâ€ atualmente sÃ³:

LÃª o HTML do editor

Mostra um alerta (gancho para futura implementaÃ§Ã£o de HTML â†’ PDF/DOCX).

PrÃ³ximo passo natural: criar uma rota /api/html_to_pdf ou /api/html_to_docx para converter o HTML do TinyMCE em arquivo e sobrescrever/gerar um novo PDF.
